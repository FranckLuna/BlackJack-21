(()=>{let e=[],t=["C","D","H","S"],n=["A","J","Q","K"],a=[];const s=document.querySelector("#btnPedir"),d=document.querySelector("#btnDetener"),o=document.querySelector("#btnNuevo"),r=document.querySelectorAll(".divCartas"),l=document.querySelectorAll("small"),c=document.getElementById("monedas-apostadas"),i=document.querySelectorAll(".monedas"),m=document.getElementById("total"),u=document.getElementById("btnBorrar"),b=document.getElementById("dinero-ganado");b.textContent=250;let h=0;const p=(t=2)=>{e=g(),a=[];for(let e=0;e<t;e++)a.push(0);l.forEach((e=>e.innerText=0)),r.forEach((e=>e.innerHTML="")),0!=h&&(s.disabled=!1,d.disabled=!1)},g=()=>{for(let n=2;n<=10;n++)for(let a of t)e.push(n+a);for(let a of t)for(esp of n)e.push(esp+a);return _.shuffle(e)},f=()=>{if(0===e.length)throw"No hay cartas en la baraja";return e.pop()},E=(e,t)=>(a[t]=a[t]+(e=>{let t=e.substring(0,e.length-1);return isNaN(t)?"A"===t?11:10:1*t})(e),l[t].innerText=a[t],a[t]),y=(e,t)=>{const n=document.createElement("img");n.src=`assets/img/cartas/${e}.png`,n.classList.add("carta"),r[t].append(n)},x=e=>{let t=0;do{const n=f();if(t=E(n,a.length-1),y(n,a.length-1),e>21)break}while(t<e&&e<=21);(()=>{const[e,t]=a;setTimeout((()=>{e>21?(alert("Te pasaste de 21. Perdiste"),L()):t>21?(alert("¡Ganaste!"),C()):e===t?alert("Empate"):e>t?(alert("¡Ganaste!"),C()):(alert("Perdiste"),L()),p(),S(),o.disabled=!0,u.disabled=!1}),500)})()};s.addEventListener("click",(()=>{const e=f(),t=E(e,0);y(e,0),t>21?(console.warn("Perdiste"),s.disabled=!0,d.disabled=!0,x(t)):21===t&&(console.warn("21 !!! Ganaste"),s.disabled=!0,d.disabled=!0,x(a))})),d.addEventListener("click",(()=>{s.disabled=!0,d.disabled=!0,x(a[0])})),o.addEventListener("click",(()=>{h>0?(p(),v(),o.disabled=!0,u.disabled=!0):alert("El total apostado no debe ser 0")})),i.forEach((e=>{e.addEventListener("click",(e=>{const t=parseInt(e.target.dataset.valor),n=e.target.dataset.img,a=parseInt(b.textContent);h+=t,m.textContent=h,h>1&&(o.disabled=!1,h>a&&(o.disabled=!0)),(e=>{const t=document.createElement("img");t.src=`assets/img/fichas/${e}.png`,t.classList.add("ficha-apostada");const n=c.clientWidth,a=c.clientHeight,s=Math.random()*(n-40),d=Math.random()*(a-40);t.style.left=`${s}px`,t.style.top=`${d}px`,c.appendChild(t)})(n),e.target.classList.add("monedas_hover"),setTimeout((()=>{e.target.classList.remove("monedas_hover")}),200)}))}));const C=()=>{const e=parseInt(b.textContent);b.textContent=e+h,h=0,m.textContent="0",c.innerHTML=""},L=()=>{const e=parseInt(b.textContent);b.textContent=e-h,h=0,m.textContent="0",c.innerHTML=""};u.addEventListener("click",(()=>{c.innerHTML="",h=0,m.textContent="0",o.disabled=!0}));const v=()=>{document.querySelectorAll(".monedas").forEach((e=>{e.disabled=!0}))},S=()=>{document.querySelectorAll(".monedas").forEach((e=>{e.disabled=!1}))}})();